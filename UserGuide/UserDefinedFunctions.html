<!DOCTYPE html><html lang="en">  <head>    <meta charset="utf-8"></meta>    <base href="/FlipDBDoc"></base>    <link href="/UserGuide.css" rel="stylesheet"></link>  </head>  <body>    <main>      <h1>User Defined Functions</h1>      <p>        An expression set may be used to implement a user-defined function.        Consider the following expression set, created and saved as        <code>/Objects/ComputeNewBalance</code>        :      </p>      <table>        <thead>          <tr>            <th class="center">Name</th>            <th class="center">Expression</th>          </tr>        </thead>        <tbody>          <tr>            <td class="center">              <code>Interest</code>            </td>            <td class="center">              <code>Balance*Rate/1200</code>            </td>          </tr>          <tr>            <td class="center">              <code>Principal</code>            </td>            <td class="center">              <code>PandI-Interest</code>            </td>          </tr>          <tr>            <td class="center">              <code>NewBalance</code>            </td>            <td class="center">              <code>Balance-Principal</code>            </td>          </tr>        </tbody>      </table>      <p>The â†’[*.evaluateExpressionSet] function executes the expression      set as a user-defined function:</p>      <table>        <thead>          <tr>            <th class="center">Name</th>            <th class="center">Expression</th>          </tr>        </thead>        <tbody>          <tr>            <td class="center">              <code>NextBalance</code>            </td>            <td class="center">              <code>evaluateExpressionSet '/Objects/ComputeNewBalance'</code>            </td>          </tr>        </tbody>      </table>      <p>        The result of        <code>evaluateExpressionSet</code>        is the value of the last expression in the expression set. Thus        the name associated with the last expression (NewBalance in this        expample) is immaterial. In the case above, we have assigned the        result to the name of our choosing,        <code>NextBalance</code>        .      </p>      <p>Note also there is no need to hide and names using a Hide column,      as the last expression is the only expression returned.</p>      <p>The evaluateExpressionSet function accepts an optional left argument.      When this argument is omitted, as in the above example, the expressions      are evaluated in the calling context. All the names in the calling      context are visible inside the expression set and may be referenced.      All assigned names are stritly local and do not affect the calling      environment.</p>      <p>A more functional approach may be taken by passing in a propertyspace      as the left argument:</p>      <table>        <thead>          <tr>            <th class="center">Name</th>            <th class="center">Expression</th>            <th class="center">Hide</th>          </tr>        </thead>        <tbody>          <tr>            <td class="center">              <code>Input</code>            </td>            <td class="center">              <code>newPropertySpace ''</code>            </td>            <td class="center">1</td>          </tr>          <tr>            <td class="center">              <code>Input.Balance</code>            </td>            <td class="center">              <code>CurrentBalance</code>            </td>            <td class="center">1</td>          </tr>          <tr>            <td class="center">              <code>Input.Rate</code>            </td>            <td class="center">              <code>Coupon</code>            </td>            <td class="center">1</td>          </tr>          <tr>            <td class="center">              <code>Input.PandI</code>            </td>            <td class="center">              <code>MonthlyPayment</code>            </td>            <td class="center">1</td>          </tr>          <tr>            <td class="center">              <code>NextBalance</code>            </td>            <td class="center">              <code>Input evaluateExpressionSet '/Objects/ComputeNewBalance'</code>            </td>            <td class="center">0</td>          </tr>        </tbody>      </table>      <p>In this case, the calling context is not available. The only names      the expression set can see are those provided in the left argument.</p>    </main>  </body></html>
