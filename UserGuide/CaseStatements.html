<!DOCTYPE html><html lang="en">  <head>    <meta charset="utf-8"></meta>    <base href="/FlipDBDoc"></base>    <link href="/UserGuide.css" rel="stylesheet"></link>  </head>  <body>    <main>      <h1>Case Statements</h1>      <p>        Expression sets may be used to implement case statements which        are executed by the →[*.evaluateCaseStatement] function. When the        expressions in the expression are all boolean valued, the expression        set is called a a        <strong>statement set</strong>        . The        <code>evaluateCaseStatement</code>        function operates on statement sets.      </p>      <p>Note: Statement sets may be used directly as the →[*.GroupBy]      property of a query.</p>      <p>        Consider the following statement set        <code>/Objects/ComputeRegion</code>        :      </p>      <table>        <thead>          <tr>            <th class="center">Name</th>            <th class="center">Expression</th>          </tr>        </thead>        <tbody>          <tr>            <td class="center">              <code>East</code>            </td>            <td class="center">              <code>State in'NY,NJ,CT'</code>            </td>          </tr>          <tr>            <td class="center">              <code>West</code>            </td>            <td class="center">              <code>State in 'CA,WA,ID,MT'</code>            </td>          </tr>          <tr>            <td class="center">              <code>South</code>            </td>            <td class="center">              <code>State in 'FL,GA,AL,MS,LA'</code>            </td>          </tr>        </tbody>      </table>      <p>This may be evaluated as:</p>      <table>        <thead>          <tr>            <th class="center">Name</th>            <th class="center">Expression</th>          </tr>        </thead>        <tbody>          <tr>            <td class="center">              <code>SalesRegion</code>            </td>            <td class="center">              <code>evaluateCaseStatement '/Objects/ComputeRegion'</code>            </td>          </tr>        </tbody>      </table>      <p>SalesRegion will be a simple column with the values East, West,      and South, one value for each row in the table.</p>      <p>It is often the case however that the desired rusult per statement      is variable and not constant. If a Value column containing expressions      is provided, it is used to compute the result rather than the name      column. For example:</p>      <table>        <thead>          <tr>            <th class="center">Expression</th>            <th class="center">Value</th>          </tr>        </thead>        <tbody>          <tr>            <td class="center">              <code>OriginalTerm in 120 240 360</code>            </td>            <td class="center">              <code>OriginalTerm</code>            </td>          </tr>          <tr>            <td class="center">              <code>OriginalTerm eq 0</code>            </td>            <td class="center">              <code>MaturityDate monthsDifference OriginationDate</code>            </td>          </tr>          <tr>            <td class="center">              <code>OriginalTerm eq OriginalTerm</code>            </td>            <td class="center">              <code>360</code>            </td>          </tr>        </tbody>      </table>      <p>In this example, the last expression is a catchall, so that any      row not caught in the first two statements will be assigned the value      360.</p>      <p>Note that when a Value column is provided, the result may be numeric      or date or any type, provided all of the types of each Value expression      are compatible.</p>      <p>        The default behavior of evaluateCaseStatement is to enforce mutually        exclusive groups. That is, if a row is selected by a statement,        it is removed from consideration in subsequent expressions. This        may be overriden by providing a 1 as the left argument, to allow        overlapping groups. When this is the case, the result of the function        is a partioned column, containing zero or more values for each        row. Consider the statement set        <code>/Objects/PriceFactors</code>        :      </p>      <table>        <thead>          <tr>            <th class="center">Name</th>            <th class="center">Expression</th>            <th class="center">Value</th>          </tr>        </thead>        <tbody>          <tr>            <td class="center">California</td>            <td class="center">              <code>State in 'CA'</code>            </td>            <td class="center">              <code>.25</code>            </td>          </tr>          <tr>            <td class="center">Condo</td>            <td class="center">              <code>PropertyType in 'Condo'</code>            </td>            <td class="center">              <code>.125</code>            </td>          </tr>          <tr>            <td class="center">HighLTV</td>            <td class="center">              <code>LTV gt 95</code>            </td>            <td class="center">              <code>1.25</code>            </td>          </tr>        </tbody>      </table>      <p>Using a left argument of 1, we can execute this and compute various      values from the result, inlcuding the number of hits, the sum the      factors, and a comma delimited list of factor that apply:</p>      <table>        <thead>          <tr>            <th class="center">Name</th>            <th class="center">Expression</th>            <th class="center">Hide</th>          </tr>        </thead>        <tbody>          <tr>            <td class="center">              <code>Factors</code>            </td>            <td class="center">              <code>1 evaluateCaseStatement 'Objects/PriceFactors'</code>            </td>            <td class="center">1</td>          </tr>          <tr>            <td class="center">              <code>FactorCount</code>            </td>            <td class="center">              <code>count Factors</code>            </td>            <td class="center">0</td>          </tr>          <tr>            <td class="center">              <code>TotalFactors</code>            </td>            <td class="center">              <code>sum Factors</code>            </td>            <td class="center">0</td>          </tr>          <tr>            <td class="center">              <code>FactorList</code>            </td>            <td class="center">              <code>toCSV Factors</code>            </td>            <td class="center">0</td>          </tr>        </tbody>      </table>    </main>  </body></html>
