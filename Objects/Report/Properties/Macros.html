<!DOCTYPE html><html lang="en">  <head>    <meta charset="utf-8"></meta>    <link href="/FlipDBDoc/Objects.css" rel="stylesheet"></link>  </head>  <body>    <main>      <h1>Macros Property</h1>      <p>Applies to:{.prefix}</p>      <p>â†’[##.##.Report]{.info}</p>      <p>The Macros property is an expression set that defines a set of      names and expressions used for text substitition throughout the report.      Just before evaluating an expression, FlipDB replaces a macro name      with its corresponding expression. Macro names are defined as standard      FlipDB names, but referenced with a leading exclamation point (!).</p>      <p>For example, consider the macro expression set:</p>      <p>        |Name|Expression| |---|-----------| |        <code>WAC</code>        |        <code>3 round weightedAverage Rate Balance</code>        | |        <code>Interest</code>        |        <code>Rate*Balance/1200</code>        | |        <code>HighLTV</code>        |        <code>LTV gt 80</code>        |      </p>      <p>        An expression in a query in the report may then refer to        <code>!WAC</code>        ,        <code>!HighLTV</code>        , or        <code>!Interest</code>        and the correponding macro expression is substituted. For example:      </p>      <table>        <thead>          <tr>            <th class="center">Name</th>            <th class="center">Expression</th>          </tr>        </thead>        <tbody>          <tr>            <td class="center">              <code>WAC</code>            </td>            <td class="center">              <code>!WAC</code>            </td>          </tr>          <tr>            <td class="center">              <code>HighLTVInt</code>            </td>            <td class="center">              <code>sum !Interest where !HighLTV</code>            </td>          </tr>        </tbody>      </table>      <p>Just before executing, the macros are expanded:</p>      <table>        <thead>          <tr>            <th class="center">Name</th>            <th class="center">Expression</th>          </tr>        </thead>        <tbody>          <tr>            <td class="center">              <code>WAC</code>            </td>            <td class="center">              <code>3 round weightedAverage Rate Balance</code>            </td>          </tr>          <tr>            <td class="center">              <code>HighLTVInt</code>            </td>            <td class="center">              <code>sum (Rate*Balance/1200) where (LTV gt 80)</code>            </td>          </tr>        </tbody>      </table>      <p>A macro is surrounded by parentheses when it is inserted into      an expression. Thus the macro value should be a complete expression,      not a fragment.</p>      <p>A macro expression itself may reference macros. If a circular      reference is detected, replacement ceases.</p>      <p>Macros provide a way to avoid duplication, making reports and      queries easier to maintain. Note the fundamental difference between      a global value and a macro: a global is evaluated at the beginning      of a report. The context of any particular query that references      the global value is irrelevant. A macro is the last-minute substituion      of text in an expression which is then evaluated in the relevant      context.</p>    </main>  </body></html>
